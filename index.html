<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Index</title>
  </head>
  <body>
    <script type="module">
      import Yici from './src/Yici.js'
      const yici = new Yici({
        timeout: 10000
      })

      yici.use((next) => async (req) => {
        const res = await next(req)

        return res
      })
      ;(async () => {
        try {
          const formData = new FormData()
          formData.append('test', 'message post')
          // const getRes = await ressage.get("http://127.0.0.1:3000/");
          const postRes = await yici.post('http://127.0.0.1:3000/', formData, {
            onResponseProgress({ ratio, being, total, speed }, chunk) {
              const GB = (speed / 1073741824).toFixed(1)
              const MB = (speed / 1048576).toFixed(1)
              const KB = (speed / 1024).toFixed(1)

              const formatRatio = `${~~(ratio * 100)}%`
              const formatSpeed = GB >= 0.1 ? `${GB}GB/s` : MB >= 0.1 ? `${MB}MB/s` : `${KB}KB/s`

              console.log(`response-progress: ${formatRatio} ${being}|${total} ${formatSpeed}`)
              debugger
            }
          })
          console.log('postRes', postRes)
          debugger
        } catch (error) {
          console.log('ðŸš€ ~ file: index.js ~ line 20 ~ error', error.message)
          debugger
        }
      })()
    </script>
  </body>
</html>
